# 2.2 増加の漸近的オーダー

サイズ $n$ の入力に対するアルゴリズムの最悪の場合の計算時間が、ある関数 $f(n)$ を用いて、 $n$ の増加に伴い $f(n)$ に比例するかあるいはそれ以下の割合で増加するかという概念を以て議論する。

- $f(n)$ は大雑把で良い
  - あまりに精密な解析は極めて困難
  - 究極の目標は、同じような振る舞いをするアルゴリズムの広いクラスを特定すること
  - １ステップは言語系によって大小する
    - 高水準言語の１個の命令は、複数の低水準命令からなる
    - 本書での**１ステップ**とは、「変数に値を割り当てること」、「配列の要素を読むこと」、「１個のポインターをたどること」、「ある固定したサイズの整数に対して１回の算術演算をすること」のいずれかとする

## $\mathrm{O},\space\Omega,\space\Theta$ の記法

### 漸近的上界

入力サイズを $n$ としたときの、あるアルゴリズムの最悪の場合の計算時間を表す関数を $T(n)$ とする。別の関数 $f(n)$ を用いて、十分大きな $n$ に対して、関数 $T(n)$ が $f(n)$ の定数倍で上から抑えられるとき、 $T(n)$ は $\mathrm{O}(f(n))$ であるという。

より正確には、定数 $c>0$ と $n_0>0$ が存在して、すべての $n\ge n_0$ に対して、 $T(n)\le c\cdot f(n)$ となるとき、 $T(n)$ は $\mathrm{O}(f(n))$ であるという（ $c$ は $n$ に依存しないことに注意）。

このとき、 $f$ を $T$ の**漸近的上界**（asymptotic upper bound）、あるいは、 $T$ は $f$ によって**漸近的に上から抑えられる**という。

> 例：$T(n)=pn^2+qn+r$ の漸近的上界（ $p,q,r$ は正の定数）
>
> すべての $n\ge1$ に対して $qn\le qn^2$ かつ $r\ge rn^2$ であるから、$T(n)=pn^2+qn+r\le pn^2+qn^2+rn^2\le(p+q+r)n^2$ が成り立つ。 $c=p+q+r$ と定めると、すべての $n\ge 1$ に対して、$T(n)\le c\cdot n^2$ であるので、 $T(n)=\mathrm{O}(n^2)$ である。
>
> また $n\ge 1$ に対して、 $n^2\le n^3$ でもあるから、$T(n)\le c\cdot n^2\le c\cdot n^3$ より、 $T(n)=\mathrm{O}(n^3)$ とも表現ができる。
>
> いずれの漸近的上界も定義を満足させる。

### 漸近的下界

定数 $\epsilon>0$ と $n_0>0$ が存在して、すべての $n\ge n_0$ に対して、$T(n)\ge\epsilon\cdot f(n)$ となるとき、 $T(n)$ は $\Omega(f(n))$ であるという（ $\epsilon$ は $n$ に依存しないことに注意）。

このとき、 $f$ を $T$ の**漸近的下界**（asymptotic lower bound）、あるいは、 $T$ は $f$ によって**漸近的に下から抑えられる**という。

> 例：$T(n)=pn^2+qn+r$ の漸近的下界（ $p,q,r$ は正の定数）
>
> $T(n)=pn^2+qn+r\ge pn^2$ が成り立つ。 $\epsilon=p(>0)$ と定めると、すべての $n\ge 1$ に対して、 $T(n)\le \epsilon\cdot n^2$ であるので、 $T(n)=\Omega(n^2)$ である。
>
> また $n\ge 1$ に対して、 $n^2\ge n$ でもあるから、$T(n)\ge \epsilon\cdot n^2\ge \epsilon\cdot n$ より、 $T(n)=\mathrm{O}(n)$ とも表現ができる。
>
> いずれの漸近的下界も定義を満足させる。

### 漸近的にタイトな限界

関数 $T(n)$ が $O(f(n))$ かつ $\Omega(f(n))$ であるとき、 $T(n)$ は $\Theta(f(n))$ であるという。

このとき、$f(n)$ は $T(n)$ に対する**漸近的にタイトな限界**（asymptotically tight bound）であるという。

> 例：$T(n)=pn^2+qn+r$ の漸近的にタイトな限界（ $p,q,r$ は正の定数）
>
> 先の議論により、 $T(n)=\mathrm{O}(n^2)=\Omega(n^2)$ である。よって、 $T(n)=\Theta (n^2)$ である。

---

漸近的にタイトな限界を直接得ることもできる。 $n$ を無限大に近づけると関数 $f(n)$ と $g(n)$ の比がある正定数に収束するならば、 $f(n)=\Theta(g(n))$である。

なぜならば、

$$\lim_{n\rightarrow\infty}{\frac{f(n)}{g(n)}}=c>0$$

であるので、極限の定義から、ある $n_0\ge0$ が存在して、 $n$ が $n_0$ を超えるとこの比の値は常に $\frac{1}{2}c$ と $2c$ の間にくることになる。したがって、すべての $n\ge n_0$ に対して $f(n)\le 2cg(n)$であり、 $f(n)=\mathrm{O}(g(n))$ が得られる。同様に、 $n\ge n_0$ に対して $f(n)\ge \frac{1}{2}cg(n)$ であり、 $f(n)=\Omega(g(n))$ が得られる。

---

極限の定義より、任意の正の定数 $\epsilon$ に対して、ある $n_0$ が存在して、 $n>n_0$ ならば、

$$\left|\frac{f(n)}{g(n)}-c\right|<\epsilon$$

が成り立つ。ここで、 $\epsilon=c$ と定めると、

$$
\begin{aligned}
\left|\frac{f(n)}{g(n)}-c\right|&<c \\
-c<\frac{f(n)}{g(n)}-c&<c \\
0<\frac{f(n)}{g(n)}&<2c \\
\end{aligned}
$$

同様に、 $\epsilon=\frac{1}{2}c$ と定めると、

$$
\begin{aligned}
\left|\frac{f(n)}{g(n)}-c\right|&<\frac{1}{2}c \\
-\frac{1}{2}c<\frac{f(n)}{g(n)}-c&<\frac{1}{2}c \\
\frac{1}{2}c<\frac{f(n)}{g(n)}&<\frac{3}{2}c \\
\end{aligned}
$$

以上により、

$$\frac{1}{2}c<\frac{f(n)}{g(n)}<2c$$

がいえる。

## 漸近的増加率の性質

### 推移律

#### (2.2)

(a) $f=\mathrm{O}(g)$ かつ $g=\mathrm{O}(h)$ ならば、 $f=\mathrm{O}(h)$ である  
(b) $f=\Omega(g)$ かつ $g=\Omega(h)$ ならば、 $f=\Omega(h)$ である

証明. (a) を示す。ある正定数 $c$ と $n_0$ に対して、すべての $n\ge n_0$ で $f(n)\le cg(n)$ で、また、ある（別の）定数 $c'$ と $n_0'$ に対して、すべての $n\ge n_0'$ で $g(n)\le c'h(n)$ である。したがって、 $n_0$ と $n_0'$ の両方よりも大きい $n$ をとれば、 $f(n)\le cg(n)\le cc'h(n)$ である。すなわち、すべての $n\ge \max{(n_0,n_0')}$ で $f(n)\le cc'h(n)$ であり、 $f=O(h)$ が得られる。

#### (2.3) $f=\Theta(g)$ かつ $g=\Theta(h)$ ならば、 $f=\Theta(h)$ である

証明. (2.2) により示される。

### 関数の和

#### (2.4) 二つの関数 $f$ と $g$ があり、他のある関数 $h$ に対して $f=\mathrm{O}(h)$ かつ $g=\mathrm{O}(h)$ であるならば、 $f+g=\mathrm{O}(h)$ である

証明. ある定数 $c$ と $n_0$ に対して、すべての $n\ge n_0$ で $f(n)\le ch(n)$ である。また、ある（別の）定数 $c'$ と $n_0'$に対して、すべての $n\ge n_0'$ で $g(n)\le c'h(n)$ である。したがって、 $n_0$ と $n_0'$ の両方よりも大きい $n$ で、すなわち、すべての $n>\max{(n_0,n_0')}$ で、 $f(n)+g(n)\le (c+c')h(n)$ であり、 $f+g=O(h)$ が得られる。

#### (2.5) $k$ を固定した整数とする。 $f_1,f_2,\ldots,f_k$ と $h$ は関数で、すべての $i$ で $f_i=O(h)$ であるとする。このとき、 $f_1+f_2+\cdots+f_k=O(h)$ である

証明. (2.4) を繰り返し用いる。

#### (2.6) $f$ と $g$ は（非負の値をとる）二つの関数で、 $g=O(f)$ であるとする。すると、 $f+g=\Theta(f)$ である。言い換えれば、 $f$ は、 $f$ と $g$ を組み合わせてできる関数 $f+g$ に対する漸近的にタイトな限界である

証明. すべての $n\ge0$ に対して $f(n)+g(n)\ge f(n)$ であるから、明らかに $f+g=\Omega(f)$ である。よって $f+g=\mathrm{O}(f)$ を示せばよい。

いま、 $g=\mathrm{O}(f)$ であり、 $f=O(f)$ が任意の関数 $f$ に対して成り立つので、 (2.4) より、 $f+g=O(f)$ が得られる。

<!-- ## 基本的な関数の漸近的限界

### 多項式

### 対数

### 指数関数 -->
