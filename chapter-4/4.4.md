# 4.4 グラフにおける最短パス

ここでは、グリーディな設計原理に基づいて開発された、グラフにおける基本的なアルゴリズムを扱う。

## 問題 4.4 最短パス（Shortest Path）

グラフは、以下に挙げるような現実世界の実問題と非常に関係が深い。

- ある地点からある目的地までの最短経路
- パケット通信におけるルーティング経路の最適化

そのようなことから、グラフの点間の最短パスを決定する問題は、基本的なアルゴリズム的問題の一つとして挙げられている。

最短パス問題は、より具体的には、以下のように設定できる。

- 有向グラフ $G=(V,E)$ と指定した始点 $s$ が与えられる
  - $G$ は $s$ から他のすべての点へのパスをもつものと仮定する
- 各辺 $e$ には長さ $l_e\ge0$ が付随する
  - これは、 $e$ を通るための必要な時間、あるいは距離はコストと考えられる
- パス $P$ に対して **$P$ の長さ**は、 $P$ に含まれるすべての辺の長さの和とし、 $l(P)$ で表す
- 目標は、 $s$ からグラフの他のすべての点への最短パスを決定することとなる
  - この議論は無向グラフにも適用できる

---

（補足）最短経路問題に関するアルゴリズムは次のように場合分けすることが可能である。

- 2頂点対最短経路問題
  - 特定の2つのノード間の最短経路問題．一般的に単一始点最短経路問題のアルゴリズムを使用する
- 単一始点最短経路問題 (SSSP：**S**ingle **S**ource **S**hortest **P**ath)
  - 特定の1つのノードから他の全ノードとの間の最短経路問題
- 全点対最短経路問題 (APSP : **A**ll **P**air **S**hortest **P**ath)
  - グラフ内のあらゆる2ノードの組み合わせについての最短経路問題

## アルゴリズム 4.5 Dijkstra のアルゴリズム（Dijkstra's Algorithm）

- 1959 年に Edsger Dijkstra が考案したアルゴリズム
- グリーディな手法で、単一始点最短経路問題への解を与える

まずは、このアルゴリズムが始点から各点への最短パスの**長さ**を求めることにする。（これから実際の最短パスを出力することも容易である）

アルゴリズムの概要は次の通りである。

- アルゴリズムは、 $s$ から最短パスの長さ $d(u)$ が確定した点の集合 $S$ を管理する
  - 最初 $S=\{s\}$ で初期化される
- 各点 $v\in V\setminus{S}$ に対して、集合 $S$ に含まれる点のみを途中経由して $v$ に到達するパスで、最短となるパスを求める
  - $u\in{S}$ として、$d'(v)=\min_{e=(u,v)\in{E}}{\{d(u)+l_{e}\}}$ を計算し、この値が最小となる $v$ を求める
  - $v$ を $S$ に加え、 $d(v)$ の値を $d'(v)$ で更新する
  - 以上の操作を $S=V$ となるまで繰り返す

[Pythonによる実装](./code/Algo4.5.py)

---

Dijkstra のアルゴリズムで得られた長さに対応する $s-t$ パスも容易に構築できる。値 $\min_{e=(u,v)\in{E}}{\{d(u)+l_{e}\}}$ を達成する辺を記録しておけば、任意の $t$ から辺を逆向きに $s$ まで辿ることで、パス $P_v$ を構築できる。アルゴリズムの定義から、 $v$ から逆向きに辿って出会う点は、 $v$ より以前に $S$ に追加されていることから、必ず $s$ に辿り着くことが保証される。
